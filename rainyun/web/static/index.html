<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Rainyun 控制台</title>
    <link rel="stylesheet" href="/static/style.css" />
  </head>
  <body>
    <div class="bg-orb orb-a"></div>
    <div class="bg-orb orb-b"></div>
    <div class="bg-orb orb-c"></div>

    <main class="app">
      <header class="app-header">
        <div>
          <p class="eyebrow">Rainyun Web Console</p>
          <h1>多账户管理面板</h1>
          <p class="subline">轻量配置、快速签到、清晰掌控。</p>
        </div>
        <button id="logout-btn" class="ghost-btn hidden">退出登录</button>
      </header>

      <section id="login-panel" class="panel">
        <div class="panel-header">
          <h2>登录</h2>
          <p>请输入管理密码获取访问权限。</p>
        </div>
        <div class="panel-body">
          <label class="field">
            <span>密码</span>
            <input id="login-password" type="password" placeholder="输入管理密码" />
          </label>
          <button id="login-btn" class="primary-btn">登录</button>
        </div>
      </section>

      <section id="dashboard" class="panel hidden">
        <div class="panel-header">
          <div>
            <h2>账户与任务</h2>
            <p>管理启用账号、续费白名单与签到操作。</p>
          </div>
          <div class="panel-actions">
            <button id="checkin-btn" class="primary-btn">一键签到</button>
            <button id="renew-btn" class="secondary-btn">一键续费</button>
          </div>
        </div>

        <div class="tab-bar">
          <button class="tab-btn active" data-tab="main">任务</button>
          <button class="tab-btn" data-tab="logs">日志</button>
        </div>

        <div id="tab-main" class="tab-content">
          <div class="panel-body">
          <div class="card" id="account-form-card">
            <div class="card-header">
              <h3 id="account-form-title">新增账户</h3>
              <div class="card-actions">
                <button id="toggle-account-form" class="ghost-btn">添加新账户</button>
                <button id="reset-form" class="ghost-btn hidden">清空</button>
              </div>
            </div>
            <div id="account-form-body" class="form-grid hidden">
              <label class="field">
                <span>账户名称</span>
                <input id="account-name" placeholder="主账号 / 副账号" />
              </label>
              <label class="field">
                <span>用户名</span>
                <input id="account-username" placeholder="雨云用户名" />
              </label>
              <label class="field">
                <span>密码</span>
                <input id="account-password" type="password" placeholder="雨云密码" />
              </label>
              <label class="field">
                <span>API Key</span>
                <input id="account-api-key" placeholder="用于服务器管理" />
              </label>
              <label class="field">
                <span>续费白名单</span>
                <input id="account-renew" placeholder="示例: 123,456" />
              </label>
              <label class="field checkbox">
                <input id="account-enabled" type="checkbox" checked />
                <span>启用账户</span>
              </label>
              <label class="field checkbox">
                <input id="account-auto-renew" type="checkbox" checked />
                <span>自动续费</span>
              </label>
              <button id="save-account" class="primary-btn full">保存账户</button>
            </div>
          </div>
          <div class="card">
            <div class="card-header">
              <h3>账户列表</h3>
              <div class="card-actions">
                <div class="toggle">
                  <span>全局自动续费</span>
                  <label class="switch">
                    <input id="setting-auto-renew" type="checkbox" />
                    <span class="slider"></span>
                  </label>
                </div>
                <button id="refresh-accounts" class="ghost-btn">刷新</button>
              </div>
            </div>
            <div class="table-wrap">
              <table>
                <thead>
                  <tr>
                    <th>名称</th>
                    <th>启用</th>
                    <th>状态</th>
                    <th>最近签到</th>
                    <th>当前积分</th>
                    <th>白名单产品</th>
                    <th>到期时间</th>
                    <th>操作</th>
                  </tr>
                </thead>
                <tbody id="accounts-body"></tbody>
              </table>
            </div>
          </div>
          </div>

          <div class="panel-body settings">
            <div class="card">
              <div class="card-header">
                <h3>系统设置</h3>
              </div>
              <div class="form-grid">
                <label class="field">
                  <span>续费阈值（天）</span>
                  <input id="setting-renew-days" type="number" min="1" />
                </label>
                <label class="field full">
                  <span>定时规则</span>
                  <div class="cron-builder">
                    <div class="cron-row">
                      <select id="cron-mode" class="cron-mode"></select>
                      <select id="cron-hour" class="cron-field"></select>
                      <select id="cron-minute" class="cron-field"></select>
                      <select id="cron-weekday" class="cron-field"></select>
                      <select id="cron-monthday" class="cron-field"></select>
                    </div>
                    <input id="setting-cron" class="cron-raw hidden" placeholder="0 8 * * *" />
                    <div class="cron-preview">
                      <span>表达式</span>
                      <code id="cron-preview">0 8 * * *</code>
                      <div id="cron-next" class="cron-next"></div>
                    </div>
                  </div>
                </label>
              </div>
            </div>
            <div class="card">
              <div class="card-header">
                <h3>通知渠道</h3>
                <div class="card-actions">
                  <button id="add-notify" class="ghost-btn">新增渠道</button>
                </div>
              </div>
              <div class="table-wrap">
                <table>
                  <thead>
                    <tr>
                      <th>名称</th>
                      <th>类型</th>
                      <th>启用</th>
                      <th>目标</th>
                      <th>操作</th>
                    </tr>
                  </thead>
                  <tbody id="notify-body"></tbody>
                </table>
              </div>
              <div id="notify-form" class="form-grid hidden">
                <label class="field">
                  <span>渠道名称</span>
                  <input id="notify-name" placeholder="自定义名称" />
                </label>
                <label class="field">
                  <span>类型</span>
                  <select id="notify-type"></select>
                </label>
                <label class="field checkbox">
                  <input id="notify-enabled" type="checkbox" checked />
                  <span>启用渠道</span>
                </label>
                <div id="notify-fields-console" class="notify-fields hidden">
                  <p class="field-tip">控制台输出无需额外配置。</p>
                </div>
                <div id="notify-fields-serverj" class="notify-fields hidden">
                  <label class="field full">
                    <span>Server酱 PUSH_KEY</span>
                    <input id="notify-push-key" placeholder="SCTxxxx 或 PUSH_KEY" />
                  </label>
                </div>
                <div id="notify-fields-telegram" class="notify-fields hidden">
                  <label class="field">
                    <span>Telegram Bot Token</span>
                    <input id="notify-tg-token" placeholder="123456:ABCDEF" />
                  </label>
                  <label class="field">
                    <span>Telegram 用户ID</span>
                    <input id="notify-tg-user" placeholder="123456789" />
                  </label>
                  <label class="field full">
                    <span>Telegram API Host（可选）</span>
                    <input id="notify-tg-host" placeholder="https://api.telegram.org" />
                  </label>
                  <label class="field">
                    <span>Telegram 代理 Host（可选）</span>
                    <input id="notify-tg-proxy-host" placeholder="127.0.0.1" />
                  </label>
                  <label class="field">
                    <span>Telegram 代理端口（可选）</span>
                    <input id="notify-tg-proxy-port" placeholder="7890" />
                  </label>
                  <label class="field full">
                    <span>Telegram 代理认证（可选）</span>
                    <input id="notify-tg-proxy-auth" placeholder="user:pass" />
                  </label>
                </div>
                <div id="notify-fields-pushplus" class="notify-fields hidden">
                  <label class="field">
                    <span>PushPlus Token</span>
                    <input id="notify-pushplus-token" placeholder="pushplus token" />
                  </label>
                  <label class="field">
                    <span>PushPlus 群组编码（可选）</span>
                    <input id="notify-pushplus-user" placeholder="group code" />
                  </label>
                  <label class="field">
                    <span>PushPlus 模板（可选）</span>
                    <input id="notify-pushplus-template" placeholder="html / markdown / txt" />
                  </label>
                  <label class="field">
                    <span>PushPlus 渠道（可选）</span>
                    <input id="notify-pushplus-channel" placeholder="wechat / webhook / cp / mail / sms" />
                  </label>
                  <label class="field">
                    <span>PushPlus Webhook（可选）</span>
                    <input id="notify-pushplus-webhook" placeholder="webhook code" />
                  </label>
                  <label class="field">
                    <span>PushPlus 回调地址（可选）</span>
                    <input id="notify-pushplus-callback" placeholder="https://example.com/callback" />
                  </label>
                  <label class="field">
                    <span>PushPlus To（可选）</span>
                    <input id="notify-pushplus-to" placeholder="好友令牌或企业微信用户ID" />
                  </label>
                </div>
                <div id="notify-fields-bark" class="notify-fields hidden">
                  <label class="field full">
                    <span>Bark 推送地址</span>
                    <input id="notify-bark-push" placeholder="https://api.day.app/xxxx" />
                  </label>
                  <label class="field">
                    <span>Bark 是否存档（可选）</span>
                    <input id="notify-bark-archive" placeholder="true / false" />
                  </label>
                  <label class="field">
                    <span>Bark 分组（可选）</span>
                    <input id="notify-bark-group" placeholder="group" />
                  </label>
                  <label class="field">
                    <span>Bark 声音（可选）</span>
                    <input id="notify-bark-sound" placeholder="sound" />
                  </label>
                  <label class="field">
                    <span>Bark 图标（可选）</span>
                    <input id="notify-bark-icon" placeholder="https://example.com/icon.png" />
                  </label>
                  <label class="field">
                    <span>Bark 时效性（可选）</span>
                    <input id="notify-bark-level" placeholder="active / timeSensitive / passive" />
                  </label>
                  <label class="field">
                    <span>Bark 跳转链接（可选）</span>
                    <input id="notify-bark-url" placeholder="https://example.com" />
                  </label>
                </div>
                <div id="notify-fields-dingding_bot" class="notify-fields hidden">
                  <label class="field">
                    <span>钉钉 Bot Token</span>
                    <input id="notify-dd-token" placeholder="access_token" />
                  </label>
                  <label class="field">
                    <span>钉钉 Bot Secret</span>
                    <input id="notify-dd-secret" placeholder="secret" />
                  </label>
                </div>
                <div id="notify-fields-feishu_bot" class="notify-fields hidden">
                  <label class="field">
                    <span>飞书 Webhook Key</span>
                    <input id="notify-fs-key" placeholder="FSKEY" />
                  </label>
                  <label class="field">
                    <span>飞书签名密钥（可选）</span>
                    <input id="notify-fs-secret" placeholder="FSSECRET" />
                  </label>
                </div>
                <div id="notify-fields-go_cqhttp" class="notify-fields hidden">
                  <label class="field full">
                    <span>Go-CQHTTP 地址</span>
                    <input id="notify-gobot-url" placeholder="http://127.0.0.1/send_private_msg" />
                  </label>
                  <label class="field full">
                    <span>推送目标</span>
                    <input id="notify-gobot-qq" placeholder="user_id=123456 或 group_id=654321" />
                  </label>
                  <label class="field full">
                    <span>Access Token（可选）</span>
                    <input id="notify-gobot-token" placeholder="access_token" />
                  </label>
                </div>
                <div id="notify-fields-gotify" class="notify-fields hidden">
                  <label class="field full">
                    <span>Gotify 地址</span>
                    <input id="notify-gotify-url" placeholder="https://push.example.com" />
                  </label>
                  <label class="field">
                    <span>Gotify Token</span>
                    <input id="notify-gotify-token" placeholder="token" />
                  </label>
                  <label class="field">
                    <span>优先级（可选）</span>
                    <input id="notify-gotify-priority" placeholder="0" />
                  </label>
                </div>
                <div id="notify-fields-igot" class="notify-fields hidden">
                  <label class="field full">
                    <span>iGot PUSH_KEY</span>
                    <input id="notify-igot-key" placeholder="IGOT_PUSH_KEY" />
                  </label>
                </div>
                <div id="notify-fields-pushdeer" class="notify-fields hidden">
                  <label class="field">
                    <span>PushDeer Key</span>
                    <input id="notify-deer-key" placeholder="DEER_KEY" />
                  </label>
                  <label class="field">
                    <span>PushDeer URL（可选）</span>
                    <input id="notify-deer-url" placeholder="https://api2.pushdeer.com/message/push" />
                  </label>
                </div>
                <div id="notify-fields-chat" class="notify-fields hidden">
                  <label class="field full">
                    <span>群晖 Chat URL</span>
                    <input id="notify-chat-url" placeholder="https://chat.example.com/webapi/entry.cgi?api=SYNO.Chat.External&method=incoming&version=2&token=" />
                  </label>
                  <label class="field full">
                    <span>群晖 Chat Token</span>
                    <input id="notify-chat-token" placeholder="token" />
                  </label>
                </div>
                <div id="notify-fields-weplus_bot" class="notify-fields hidden">
                  <label class="field">
                    <span>微加 Token</span>
                    <input id="notify-weplus-token" placeholder="WE_PLUS_BOT_TOKEN" />
                  </label>
                  <label class="field">
                    <span>接收者（可选）</span>
                    <input id="notify-weplus-receiver" placeholder="receiver" />
                  </label>
                  <label class="field">
                    <span>版本（可选）</span>
                    <input id="notify-weplus-version" placeholder="pro" />
                  </label>
                </div>
                <div id="notify-fields-qmsg_bot" class="notify-fields hidden">
                  <label class="field">
                    <span>Qmsg Key</span>
                    <input id="notify-qmsg-key" placeholder="QMSG_KEY" />
                  </label>
                  <label class="field">
                    <span>Qmsg Type</span>
                    <input id="notify-qmsg-type" placeholder="send / group / push" />
                  </label>
                </div>
                <div id="notify-fields-wecom_app" class="notify-fields hidden">
                  <label class="field full">
                    <span>企业微信应用配置</span>
                    <input id="notify-wecom-am" placeholder="corpid,corpsecret,touser,agentid,media_id(可选)" />
                  </label>
                  <label class="field full">
                    <span>企业微信代理（可选）</span>
                    <input id="notify-wecom-origin" placeholder="https://qyapi.weixin.qq.com" />
                  </label>
                </div>
                <div id="notify-fields-wecom_bot" class="notify-fields hidden">
                  <label class="field full">
                    <span>企业微信机器人 Key</span>
                    <input id="notify-wecom-key" placeholder="QYWX_KEY" />
                  </label>
                  <label class="field full">
                    <span>企业微信代理（可选）</span>
                    <input id="notify-wecom-bot-origin" placeholder="https://qyapi.weixin.qq.com" />
                  </label>
                </div>
                <div id="notify-fields-aibotk" class="notify-fields hidden">
                  <label class="field">
                    <span>智能微秘书 Key</span>
                    <input id="notify-aibotk-key" placeholder="AIBOTK_KEY" />
                  </label>
                  <label class="field">
                    <span>发送类型</span>
                    <input id="notify-aibotk-type" placeholder="room / contact" />
                  </label>
                  <label class="field">
                    <span>目标名称</span>
                    <input id="notify-aibotk-name" placeholder="群名或好友昵称" />
                  </label>
                </div>
                <div id="notify-fields-smtp" class="notify-fields hidden">
                  <label class="field full">
                    <span>SMTP 服务器</span>
                    <input id="notify-smtp-server" placeholder="smtp.example.com:465" />
                  </label>
                  <label class="field">
                    <span>SMTP SSL</span>
                    <input id="notify-smtp-ssl" placeholder="true / false" />
                  </label>
                  <label class="field">
                    <span>SMTP 邮箱</span>
                    <input id="notify-smtp-email" placeholder="me@example.com" />
                  </label>
                  <label class="field">
                    <span>SMTP 密码</span>
                    <input id="notify-smtp-password" placeholder="password" />
                  </label>
                  <label class="field">
                    <span>SMTP 发件人</span>
                    <input id="notify-smtp-name" placeholder="Rainyun Bot" />
                  </label>
                </div>
                <div id="notify-fields-pushme" class="notify-fields hidden">
                  <label class="field">
                    <span>PushMe Key</span>
                    <input id="notify-pushme-key" placeholder="PUSHME_KEY" />
                  </label>
                  <label class="field">
                    <span>PushMe URL（可选）</span>
                    <input id="notify-pushme-url" placeholder="https://push.i-i.me/" />
                  </label>
                  <label class="field">
                    <span>PushMe date（可选）</span>
                    <input id="notify-pushme-date" placeholder="date" />
                  </label>
                  <label class="field">
                    <span>PushMe type（可选）</span>
                    <input id="notify-pushme-type" placeholder="type" />
                  </label>
                </div>
                <div id="notify-fields-chronocat" class="notify-fields hidden">
                  <label class="field full">
                    <span>Chronocat URL</span>
                    <input id="notify-chronocat-url" placeholder="http://127.0.0.1:16530" />
                  </label>
                  <label class="field full">
                    <span>Chronocat Token</span>
                    <input id="notify-chronocat-token" placeholder="token" />
                  </label>
                  <label class="field full">
                    <span>目标QQ</span>
                    <input id="notify-chronocat-qq" placeholder="user_id=123;group_id=456" />
                  </label>
                </div>
                <div id="notify-fields-ntfy" class="notify-fields hidden">
                  <label class="field">
                    <span>Ntfy 地址</span>
                    <input id="notify-ntfy-url" placeholder="https://ntfy.sh" />
                  </label>
                  <label class="field">
                    <span>Ntfy Topic</span>
                    <input id="notify-ntfy-topic" placeholder="topic" />
                  </label>
                  <label class="field">
                    <span>Ntfy 优先级（可选）</span>
                    <input id="notify-ntfy-priority" placeholder="3" />
                  </label>
                  <label class="field">
                    <span>Ntfy Token（可选）</span>
                    <input id="notify-ntfy-token" placeholder="token" />
                  </label>
                  <label class="field">
                    <span>Ntfy 用户名（可选）</span>
                    <input id="notify-ntfy-username" placeholder="username" />
                  </label>
                  <label class="field">
                    <span>Ntfy 密码（可选）</span>
                    <input id="notify-ntfy-password" placeholder="password" />
                  </label>
                  <label class="field full">
                    <span>Ntfy Actions（可选）</span>
                    <input id="notify-ntfy-actions" placeholder="action label=Open, url=https://example.com" />
                  </label>
                </div>
                <div id="notify-fields-wxpusher_bot" class="notify-fields hidden">
                  <label class="field">
                    <span>WxPusher AppToken</span>
                    <input id="notify-wxpusher-token" placeholder="appToken" />
                  </label>
                  <label class="field">
                    <span>WxPusher Topic IDs（可选）</span>
                    <input id="notify-wxpusher-topic" placeholder="10001;10002" />
                  </label>
                  <label class="field">
                    <span>WxPusher UIDs（可选）</span>
                    <input id="notify-wxpusher-uids" placeholder="UID_xxx;UID_yyy" />
                  </label>
                </div>
                <div id="notify-fields-custom_notify" class="notify-fields hidden">
                  <label class="field full">
                    <span>Webhook URL</span>
                    <input id="notify-webhook-url" placeholder="https://example.com/hook?title=$title&content=$content" />
                  </label>
                  <label class="field">
                    <span>Webhook 方法</span>
                    <input id="notify-webhook-method" placeholder="POST" />
                  </label>
                  <label class="field">
                    <span>Content-Type（可选）</span>
                    <input id="notify-webhook-content-type" placeholder="application/json" />
                  </label>
                  <label class="field full">
                    <span>Webhook Headers（可选）</span>
                    <textarea id="notify-webhook-headers" rows="3" placeholder="Authorization: Bearer xxx"></textarea>
                  </label>
                  <label class="field full">
                    <span>Webhook Body（可选）</span>
                    <textarea id="notify-webhook-body" rows="5" placeholder="title: $title&#10;content: $content"></textarea>
                  </label>
                </div>
                <div id="notify-fields-custom" class="notify-fields hidden">
                  <label class="field full">
                    <span>自定义 JSON 配置</span>
                    <textarea id="notify-custom-config" rows="6" placeholder="{ }"></textarea>
                  </label>
                </div>
                <button id="save-notify" class="primary-btn full">保存渠道</button>
                <button id="cancel-notify" class="ghost-btn full">取消编辑</button>
              </div>
            </div>
            <div class="card">
              <div class="card-header">
                <h3>高级设置</h3>
              </div>
              <div class="form-grid">
                <label class="field">
                  <span>页面超时（秒）</span>
                  <input id="setting-timeout" type="number" min="1" />
                </label>
                <label class="field">
                  <span>随机延时上限（分钟）</span>
                  <input id="setting-max-delay" type="number" min="0" />
                </label>
                <label class="field checkbox">
                  <input id="setting-debug" type="checkbox" />
                  <span>调试模式（跳过延时）</span>
                </label>
                <label class="field">
                  <span>请求超时（秒）</span>
                  <input id="setting-request-timeout" type="number" min="1" />
                </label>
                <label class="field">
                  <span>请求重试次数</span>
                  <input id="setting-max-retries" type="number" min="0" />
                </label>
                <label class="field">
                  <span>请求重试间隔（秒）</span>
                  <input id="setting-retry-delay" type="number" min="0" step="0.5" />
                </label>
                <label class="field">
                  <span>下载超时（秒）</span>
                  <input id="setting-download-timeout" type="number" min="1" />
                </label>
                <label class="field">
                  <span>下载重试次数</span>
                  <input id="setting-download-max-retries" type="number" min="0" />
                </label>
                <label class="field">
                  <span>下载重试间隔（秒）</span>
                  <input id="setting-download-retry-delay" type="number" min="0" step="0.5" />
                </label>
                <label class="field">
                  <span>验证码重试次数</span>
                  <input id="setting-captcha-retry-limit" type="number" min="0" />
                </label>
                <label class="field checkbox">
                  <input id="setting-captcha-retry-unlimited" type="checkbox" />
                  <span>验证码无限重试</span>
                </label>
                <label class="field checkbox">
                  <input id="setting-captcha-save-samples" type="checkbox" />
                  <span>保存验证码样本</span>
                </label>
                <label class="field full">
                  <span>跳过推送标题（换行分隔）</span>
                  <textarea id="setting-skip-push-title" rows="3"></textarea>
                </label>
              </div>
            </div>
            <div class="card settings-footer">
              <div class="form-grid">
                <button id="save-settings" class="primary-btn full">保存设置</button>
              </div>
            </div>
          </div>
        </div>

        <div id="tab-logs" class="tab-content hidden">
          <div class="panel-body">
            <div class="card">
              <div class="card-header">
                <h3>实时日志</h3>
                <div class="card-actions">
                  <label class="field checkbox small">
                    <input id="log-auto-refresh" type="checkbox" checked />
                    <span>自动刷新</span>
                  </label>
                  <button id="refresh-logs" class="ghost-btn">刷新</button>
                  <button id="clear-logs" class="ghost-btn">清空日志</button>
                </div>
              </div>
              <pre id="log-output" class="log-output"></pre>
            </div>
          </div>
        </div>
      </section>
    </main>

    <div id="toast" class="toast hidden"></div>
    <script src="/static/app.js"></script>
  </body>
</html>
